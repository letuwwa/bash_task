function main {
 configFile=/etc/sysconfig/network-scripts/ifcfg-enp0s3

 if grep -q ONBOOT=yes $configFile
  then echo "ONBOOT=yes, config is corect"
 else
  echo "ONBOOT setted on YES, config is changed"
  sed -i '$ d' $configFile
  echo "ONBOOT=yes" >> $configFile
 fi


 sshdConfig=/etc/ssh/sshd_config

 if grep -q 'PermitRootLogin no' $sshdConfig
  then echo 'PermitRootLogin no, config is correct'
 else
  echo "PermitRootLogin setted on NO, config is changed"
  grep '#PermitRootLogin yes' -P -R -I -l $sshdConfig | xargs sed -i 's/#PermitRootLogin yes/PermitRootLogin no/g'
 fi


 iptables -A INPUT -p tcp --dport 22 -j ACCEPT
 yum update -y --disablerepo=*


 repoFile=/etc/yum.repos.d/mnt_iso_.repo

 if [ -f "$repoFile" ];
 then
    echo "File $repoFile exist, repo is enabled"
 else
    mkdir -p /mnt/iso
    mount -o loop CentOS-7-x86_64-DVD-2009.iso /mnt/iso
    yum-config-manager --add-repo=file:///mnt/iso
    echo "File $repoFile does not exist, repo created and enabled"
 fi

 (echo n; echo p; echo 1; echo ; echo ; echo t; echo fd; echo w) | fdisk /dev/sdb
 (echo n; echo p; echo 1; echo ; echo ; echo t; echo fd; echo w) | fdisk /dev/sdc
 (echo n; echo p; echo 1; echo ; echo ; echo t; echo fd; echo w) | fdisk /dev/sdd
 mdadm --create /dev/md5 --level=5 --raid-devices=3 /dev/sd[b-d]


 pvcreate /dev/md5
 mkfs.ext4 /dev/md5
 mount /dev/md5 /mnt
}

main 2>&1 | tee -a file.log
